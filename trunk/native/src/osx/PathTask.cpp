/*    PathTask.cpp    FOR OSX!!        This is based on original work done by Nate Roe.    @author Paul Gregoire (mondain@gmail.com)*/#include "PathTask.h"#include <iostream>JNIEXPORT void JNICALL Java_org_gregoire_tools_PathTask_addToPath(JNIEnv *env, jclass clazz, jstring jpath) {/*    http://www.onjava.com/pub/a/onjava/2003/10/08/macosxjava.html    http://developer.apple.com/qa/java/java28.html    http://developer.apple.com/documentation/Java/Conceptual/Java14Development/05-CoreJavaAPIs/CoreJavaAPIs.html    XXX Paul notes:         1. Default path in osx is: .:/usr/lib:/usr/lib/java:/lib:/System/Library/Framworks/JavaVM.framework/Versions/1.3/Libraries        2. Library extension should be: .jnilib*/	char *oldPath = getenv("DYLD_LIBRARY_PATH");	const char *path = env->GetStringUTFChars(jpath, 0);	if (path) {		int oldLen = strlen(oldPath);		char *newPath = new char[oldLen + strlen(path) + 7];		strcpy(newPath, "DYLD_LIBRARY_PATH=");		strcpy(newPath + 5, oldPath);		strcpy(newPath + oldLen + 5, ":");		strcpy(newPath + oldLen + 6, path);		_putenv(newPath);		delete [] newPath;		env->ReleaseStringUTFChars(jpath, path);	} else {		// something went wrong, report or throw or something.	}}